# https://taskfile.dev

version: '3'

vars:
  GIT_COMMIT: {sh: git log -n 1 --format=%h}

tasks:

  default:
    cmds:
      - task: build

  depend:
    cmds:
      - go get -v -u

  prepare:
    cmds:
      - npm install -g less
      - cd contrib && lessc main.less main.css
      - cp contrib/main.css static/css/main.css

  build:
    env:
      GOOS: "darwin"
      GOARCH: "amd64"
      CGO_ENABLED: "1"
    cmds:
      - go build -o golden-darwin-amd64 .
    generates:
      - golden-darwin-amd64

  package:
    cmds:
      - echo "No package."
